<!DOCTYPE html>
<html>
<head>
    <title>LUVEX UV Strip Analyzer</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/luvex-app-design-system.css">
</head>
<body>
    <!-- Header with LUVEX Branding -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <!-- LUVEX Logo -->
                <img src="assets/images/luvex-logo-transparency.png" 
                     alt="LUVEX Logo" 
                     class="luvex-logo"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                
                <!-- Fallback Text Logo -->
                <div class="luvex-logo" style="display: none; font-size: 2rem; font-weight: bold; color: var(--luvex-bright-cyan);">
                    LUVEX
                </div>
            </div>
            
            <div class="brand-text">
                <div class="brand-title">UV Strip Analyzer</div>
                <div class="brand-subtitle">Professional UV Dosimetry</div>
            </div>
            
            <div class="status-indicators">
                <div class="status-dot"></div>
                <span class="status-text">System Ready</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Column: Analysis Workflow -->
        <div class="left-column">
            <!-- Analysis Mode Selection -->
            <div class="card">
                <h2 class="card__title">
                    Analyse-Modus
                </h2>
                
                <div class="mode-selection">
                    <div class="mode-toggle">
                        <button id="modeWithReference" class="mode-toggle-btn active">
                            Referenz im Bild
                        </button>
                        <button id="modeSavedReference" class="mode-toggle-btn">
                            Gespeicherte Referenz
                        </button>
                    </div>
                    <div class="mode-description">
                        <span id="modeDescription">Strip und Referenzskala nebeneinander fotografieren (empfohlen)</span>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="card">
                <h2 class="card__title">
                    UV-Strip Analyse
                </h2>
                
                <!-- Upload Container - Mode 1: Single Image -->
                <div id="uploadMode1" class="upload-container">
                    <div id="uploadAreaCombined" class="upload-area">
                        <div class="upload-text">Strip + Referenz hochladen</div>
                        <div class="upload-subtext">Beide nebeneinander im gleichen Bild</div>
                    </div>
                </div>

                <!-- Upload Container - Mode 2: Strip + Reference Selection -->
                <div id="uploadMode2" class="upload-container" style="display: none;">
                    <div id="uploadAreaStrip" class="upload-area">
                        <div class="upload-text">UV-Strip hochladen</div>
                        <div class="upload-subtext">JPG, PNG, GIF (max. 10MB)</div>
                    </div>
                </div>

                <!-- Reference Selector for Mode 2 -->
                <div id="referenceSelector" class="reference-selector">
                    <label for="referenceDropdown" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: var(--font-weight-medium);">
                        Referenzskala auswählen:
                    </label>
                    <select id="referenceDropdown" class="reference-dropdown">
                        <option value="">-- Referenz auswählen --</option>
                        <option value="standard">Standard UV-Strip (0-500 J/cm²)</option>
                        <option value="uvc">UVC-Strip (0-100 J/cm²)</option>
                        <option value="uva">UVA-Strip (0-1000 J/cm²)</option>
                    </select>
                    <div style="margin-top: 0.5rem; font-size: var(--text-sm); color: var(--text-secondary);">
                        Wählen Sie die passende Referenzskala für Ihren Strip-Typ
                    </div>
                </div>
                
                <input type="file" id="fileInputCombined" accept="image/*">
                <input type="file" id="fileInputStrip" accept="image/*">
                
                <div id="statusMessage" class="status-message"></div>
                <div id="loadingSpinner" class="loading-spinner"></div>
                
                <!-- Image Preview -->
                <div id="imagePreview" class="image-preview"></div>
                
                <!-- Action Buttons -->
                <div style="text-align: center; margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: center;">
                    <button id="analyzeBtn" class="btn luvex-cta-primary" disabled>
                        Analyse starten
                    </button>
                    <button id="resetBtn" class="btn luvex-cta-secondary">
                        Reset
                    </button>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsContainer" class="card results-container">
                <h3 class="card__title">
                    Analyseergebnisse
                </h3>
                <div id="resultsContent"></div>
            </div>
        </div>

        <!-- Right Column: Controls & Info -->
        <div class="right-column">
            <!-- Live Analysis Dashboard -->
            <div class="card">
                <h3 class="card__title">
                    Dashboard
                </h3>
                
                <div class="dashboard-panel">
                    <div class="panel-header">
                        Aktuelle Messung
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Modus:</span>
                        <span class="metric-value" id="currentMode">Referenz im Bild</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Verarbeitungszeit:</span>
                        <span class="metric-value" id="processingTime">--</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Konfidenz:</span>
                        <span class="metric-value" id="confidenceLevel">--</span>
                    </div>
                </div>

                <div class="dashboard-panel">
                    <div class="panel-header">
                        System Status
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Backend:</span>
                        <span class="metric-value" style="color: #10b981;" id="backendStatus">Online</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Letzte Analyse:</span>
                        <span class="metric-value" id="lastAnalysis">Nie</span>
                    </div>
                </div>
            </div>

            <!-- Reference Library -->
            <div class="card">
                <h3 class="card__title">
                    Referenzbibliothek
                </h3>
                
                <div id="referenceList" class="dashboard-panel">
                    <!-- Dynamic list loaded by JS -->
                </div>

                <div class="quick-actions">
                    <button id="addReferenceBtn" class="btn luvex-cta-secondary">
                        Referenz hinzufügen
                    </button>
                    <button id="manageLibraryBtn" class="btn luvex-cta-secondary" disabled>
                        Bibliothek verwalten
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <h3 class="card__title">
                    Aktionen
                </h3>
                <div class="quick-actions">
                    <button id="showAllMeasurementsBtn" class="btn luvex-cta-secondary">
                        Alle Messungen
                    </button>
                    <button class="btn luvex-cta-secondary">
                        Report exportieren
                    </button>
                    <button id="settingsBtn" class="btn luvex-cta-secondary">
                        Einstellungen
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Measurements Modal -->
    <div id="measurementsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Alle Messungen</h2>
                <button id="closeMeasurementsModalBtn" class="modal-close-btn">&times;</button>
            </div>
            <div id="measurementsList" class="modal-body">
                <!-- Measurement items will be injected here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Add Reference Modal -->
    <div id="addReferenceModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Neue Referenz hinzufügen</h2>
                <button id="closeAddReferenceModalBtn" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="save-form">
                    <label for="newReferenceName">Referenzname</label>
                    <input type="text" id="newReferenceName" placeholder="z.B. UVC High-Power Strip">
                    
                    <label for="newReferenceRange">Messbereich</label>
                    <input type="text" id="newReferenceRange" placeholder="z.B. 0-1000 J/cm²">

                    <label>Referenzbild</label>
                    <div id="uploadAreaReference" class="upload-area modal-upload-area">
                        <div class="upload-text">Bild hochladen</div>
                        <div class="upload-subtext">JPG, PNG (max. 2MB)</div>
                    </div>
                    <input type="file" id="fileInputReference" accept="image/*" style="display: none;">
                    <div id="referenceImagePreview" class="image-preview"></div>

                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button id="saveReferenceBtn" class="btn luvex-cta-primary" style="flex: 1;">
                            Speichern
                        </button>
                        <button id="cancelReferenceBtn" class="btn luvex-cta-secondary" style="flex: 1;">
                            Abbrechen
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Manage Library Modal -->
    <div id="manageLibraryModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Bibliothek verwalten</h2>
                <button id="closeManageLibraryModalBtn" class="modal-close-btn">&times;</button>
            </div>
            <div id="manageLibraryList" class="modal-body">
                <!-- Management list will be injected here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Einstellungen</h2>
                <button id="closeSettingsModalBtn" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Datenverwaltung</h3>
                    <p>Aktionen zum Zurücksetzen der im Browser gespeicherten Daten.</p>
                    <div class="settings-actions">
                        <button id="deleteAllMeasurementsBtn" class="btn btn-danger">Alle Messungen löschen</button>
                        <button id="deleteAllReferencesBtn" class="btn btn-danger">Alle Referenzen löschen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="confirmModal" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2 id="confirmTitle">Aktion bestätigen</h2>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Möchten Sie diesen Vorgang wirklich fortsetzen?</p>
                <div class="confirm-actions">
                    <button id="confirmOkBtn" class="btn btn-danger">Löschen</button>
                    <button id="confirmCancelBtn" class="btn luvex-cta-secondary">Abbrechen</button>
                </div>
            </div>
        </div>
    </div>


    <!-- JavaScript -->
    <script src="assets/js/luvex-app-main.js"></script>
</body>
</html>
